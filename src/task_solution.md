# Решение задания

1. [Установка ОС](#part-1-установка-ос)  
2. [Создание пользователя](#part-2-создание-пользователя)  
3. [Настройка сети ОС](#part-3-настройка-сети-ос)   
4. [Обновление ОС](#part-4-обновление-ос)  
5. [Использование команды  sudo](#part-5-использование-команды-sudo)  
6. [Установка и настройка службы времени](#part-6-установка-и-настройка-службы-времени)  
7. [Установка и использование текстовых редакторов](#part-7-установка-и-использование-текстовых-редакторов)  
8. [Установка и базовая настройка сервиса SSHD](#part-8-установка-и-базовая-настройка-сервиса-sshd)   
9. [Установка и использование утилит top, htop](#part-9-установка-и-использование-утилит-top-htop)   
10. [Использование утилиты fdisk](#part-10-использование-утилиты-fdisk)   
11. [Использование утилиты df](#part-11-использование-утилиты-df)    
12. [Использование утилиты du](#part-12-использование-утилиты-du)    
13. [Установка и использование утилиты ncdu](#part-13-установка-и-использование-утилиты-ncdu)    
14. [Работа с системными журналами](#part-14-работа-с-системными-журналами)     
15. [Использование планировщика заданий CRON](#part-15-использование-планировщика-заданий-cron)    

## Part 1. Установка ОС

**== Задание ==**

##### Установить **Ubuntu 20.04 Server LTS** без графического интерфейса. (Используем программу для виртуализации - VirtualBox)

- Графический интерфейс должен отсутствовать.

- Узнайте версию Ubuntu, выполнив команду \
`cat /etc/issue.`
- Вставьте скриншот с выводом команды.

**== Решение ==**

- Была установлена **Ubuntu 20.04.2 Server LTS** без графического интерфейса.

- Результат выполнения команды `cat /etc/issue`:

    ![](screens/part1.png)

## Part 2. Создание пользователя

**== Задание ==**

##### Создать пользователя, отличного от пользователя, который создавался при установке. Пользователь должен быть добавлен в группу `adm`.

- Вставьте скриншот вызова команды для создания пользователя.
- Новый пользователь должен быть в выводе команды \
`cat /etc/passwd`
- Вставьте скриншот с выводом команды.

**== Решение ==**

- Создадим нового пользователя `(newuser)` с помощью команды:
    ```
    sudo adduser newuser
    ```

    ![](screens/part2.11.png)

- Добавим нового пользователя `(newuser)` в группу `adm` с помощью команды:
    ```
    sudo usermod -a -G adm newuser
    ```

    ![](screens/part2.33.png)

- Новый пользователь присутствует в выводе команды
`cat /etc/passwd`

    ![](screens/part2.22.png)

## Part 3. Настройка сети ОС

**== Задание ==**

##### Задать название машины вида user-1  
##### Установить временную зону, соответствующую вашему текущему местоположению.  
##### Вывести названия сетевых интерфейсов с помощью консольной команды.
- В отчёте дать объяснение наличию интерфейса lo.  
##### Используя консольную команду получить ip адрес устройства, на котором вы работаете, от DHCP сервера. 
- В отчёте дать расшифровку DHCP.  
##### Определить и вывести на экран внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw). 
##### Задать статичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (использовать публичный DNS серверы, например 1.1.1.1 или 8.8.8.8).  
##### Перезагрузить виртуальную машину. Убедиться, что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте.  

- В отчёте опишите, что сделали для выполнения всех семи пунктов (можно как текстом, так и скриншотами).
- Успешно пропинговать удаленные хосты 1.1.1.1 и ya.ru и вставить в отчёт скрин с выводом команды. В выводе команды должна быть фраза "0% packet loss".

**== Решение ==**

- Чтобы узнать название машины, заданное при установке ОС, воспользуемся командой `hostname`. Зададим новое название машины: `user-1`; с помощью команды:
    ```
    sudo hostname user-1
    ```
- После выполнения этой команды проверим текущее название командой `hostname`

    ![](screens/part3.hostchange.png)

- После выполнения перезагрузки машины командой `reboot` выставленное ранее название сбросится, поэтому воспользуемся командой:
    ```
    sudo hostnamectl set-hostname user-1
    ```

    ![](screens/part3.hostchange2.png)

- После повторной перезагрузки, наименование машины не изменится.

---

- Чтобы узнать какая временная зона установлена на данный момент можно воспользоваться командой `date`. Данная временная зона не соответствует текущему местоположению:

    ![](screens/part3.datecheck.png)

- Для изменения часового пояса на требуемый Europe/Moscow, используем команду:
    ```
    sudo timedatectl set-timezone Europe/Moscow
    ```

    ![](screens/part3.chng.timedate.png)

- Повторная проверка текущей временной зоны, выполненная с помощью команды `date`, показала актуальные значения.
---

- Вывести названия сетевых интерфейсов с помощью консольных команд:
    ```
    ip l
    ```
    ```
    ip address
    ```
    ```
    ls /sys/class/net
    ```

    ![](screens/part3.interfacesList.png)

- >lo (loopback device) – виртуальный интерфейс, присутствующий по умолчанию в любом Linux. Он используется для отладки сетевых программ и запуска серверных приложений на локальной машине. С этим интерфейсом всегда связан адрес 127.0.0.1. У него есть dns-имя – localhost. Интерфейс lo является локальной петлёй. Она предназначена для обеспечения сетевого доступа к компьютеру.

---

- Чтобы узнать ip адрес машины, выданный ей DHCP сервером воспользуемся командой:
    ```
    cat /var/log/syslog | grep -i dhcp
    ```

    ![](screens/part3.DHCPgrep.png)
    
- На скриншоте видно, что DHCP выдал компьютеру ip адрес: 10.0.2.15/24

- Также ip адрес машины, выданный ей DHCP сервером, можно узнать с помощью команды: 
    ```
    ip r
    ```
    ![](screens/part3.DHCPno-grep.png)

- >DHCP (Dynamic Host Configuration Protocol) - протокол динамической конфигурации хоста. Сетевой протокол, позволяющий устройствам автоматически получать IP-адрес и другие параметры, необходимые для работы в сети TCP/IP. Данный протокол работает по модели «клиент-сервер». Для автоматической конфигурации компьютер-клиент на этапе конфигурации сетевого устройства обращается к так называемому серверу DHCP и получает от него нужные параметры. IP-адрес (Internet Protocol) - способ адресации устройств по сети.

---
- Чтобы определить и вывести на экран внешний ip-адрес шлюза (ip) воспользуемся командой:
    ```
    curl ifconfig.co
    ```
    ![](screens/part3.outsideIP.png)


- Чтобы определить и вывести на экран внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw), можно воспользоваться командами:
    ```
    ip route
    ```
    ```
    route -n
    ```
    ![](screens/part3.insideIPtrue.png)
    
- Как видно из скриншотов, внешний IP-адрес шлюза: 109.248.252.99; а внутренний: 10.0.2.2.
---

- Зададим статичные (заданные вручную, а не полученные от DHCP сервера) настройки ip, gw, dns (используя публичные DNS серверы, например 1.1.1.1 или 8.8.8.8). DHCP автоматически присваивает устройству IP, поэтому сначала необходимо отключить облачную инициализацию. Нужно открыть файл конфигурации `subiquity-disable-cloudinit-networking.cfg` в каталоге `/etc/cloud/cloud.cfg.d/` с помощью команды:
```
sudo vim /etc/cloud/cloud.cfg.d/subiquity-disable-cloudinit-networking.cfg
```

- Необходимо, чтобы было: `config: disabled`

    ![](screens/part3.check_otkl_DHCP.png)

- Откроем файл конфигурации `netplan` в текстовом редакторе `vim` с помощью команды:
    ```
    sudo vim /etc/netplan/00-installer-config.yaml
    ```

    ![](screens/part3.содержание_файла_конфигурации.png)

- Зададим статические настройки: изменим параметр dhcp4 на значение `false`, в `addresses` укажем статический IP-адрес: `10.0.2.32/24`, и в `gateway4` зададим внутренний IP-адрес `10.0.2.2`. В параметре `addresses` раздела `nameservers` укажем публичные серверы.

    ![](screens/part3.change_file_conf_stat_IP.png)

- Для применения изменений используем команду:
    ```
    netplan apply
    ```

- Далее перезагрузим виртуальную машину командой `reboot` и проверяем сохранились ли выставленные вручную настройки (проверяем сохранились ли изменения в файле конфигурации). Для этого воспользуемся командой:
    ```
    cat /etc/netplan/00-installer-config.yaml
    ```

    ![](screens/part3.проверка_статического_айпи_1.png)

- Также, для проверки статического IP-адреса можно использовать команды:
    ```
    ip route show
    ```
    ```
    ifconfig
    ```

    ![](screens/part3.проверка_статического_айпи_2.png)

- На скриншотах видно, что выставленный вручную статический IP-адрес `10.0.2.32` после перезагрузки остался неизменным.
---

- Пропингуем удаленные хосты 1.1.1.1 и ya.ru с помощью команд:
    ```
    ping 1.1.1.1 -c 3
    ```
    ```
    ping ya.ru -c 3
    ```
    ![](screens/part3.пропинговка.png)

- На скриншоте видно, что выводе команды присутвствует фраза `0% packet loss`, это свидетельствует о том, что компьютер получил ответ от всех отправленных на указанные сервера пакетов данных.

- >Ping — утилита для проверки целостности и качества соединений в сетях. Утилита отправляет запросы указанному узлу сети и фиксирует поступающие ответы. Время между отправкой запроса и получением ответа позволяет определять двусторонние задержки по маршруту и частоту потери пакетов, то есть косвенно определять загруженность на каналах передачи данных и промежуточных устройствах.

## Part 4. Обновление ОС

**== Задание ==**

##### Обновить системные пакеты до последней на момент выполнения задания версии.  

- После обновления системных пакетов, если ввести команду обновления повторно, должно появится сообщение, что обновления отсутствуют.
- Вставить скриншот с этим сообщением в отчёт.

**== Решение ==**

- Для обновления индекса пакетов или списка пакетов, воспользуемся командой:
    ```
    sudo apt update
    ```
- Обновим системные пакеты до последней, на момент выполнения задания, версии, используя команду:
    ```
    sudo apt full-upgrade
    ```
    ![](screens/part4.1.png)

- После обновления системных пакетов видим, что при повторном введении двух последних команд получены сообщения об отсутствии новых обновлений
    ![](screens/part4.2.png)

## Part 5. Использование команды **sudo**

**== Задание ==**

##### Разрешить пользователю, созданному в [Part 2](#part-2-создание-пользователя), выполнять команду sudo.

- В отчёте объяснить *истинное* назначение команды sudo (про то, что это слово - "волшебное", писать не стоит).  
- Поменять hostname ОС от имени пользователя, созданного в пункте [Part 2](#part-2-создание-пользователя) (используя sudo).
- Вставить скрин с изменённым hostname в отчёт.

**== Решение ==**

- Разрешим пользователю, созданному в [Part 2](#part-2-создание-пользователя), выполнять команду sudo. Для этого необходимо добавить пользователя `newuser` в группу `sudo`. Воспользуемся командой:
    ```
    sudo usermod -a -G sudo newuser
    ```
- Проверим к каким группам принадлежит пользователь `newuser` с помощью команды:
    ```
    groups newuser
    ```

    ![](screens/part5.1.png)

- На скриншоте видно, что пользователь был добавлен в группу `sudo`. Это дает ему возможность выполнять команду `sudo`.

- >Sudo (Substitute user and do - подменить пользователя и выполнить) – это утилита для операционных систем семейства Linux, позволяющая пользователю запускать программы с привилегиями другой учётной записи, как правило, суперпользователя.

- Поменяем hostname ОС от имени пользователя, созданного в пункте [Part 2](#part-2-создание-пользователя) (используя sudo). Для этого необходимо сменить текущего пользователя `user1` на ранее созданного `newuser` с помощью команды:
    ```
    su newuser
    ```

    ![](screens/part5.user_change.png)

- Чтобы узнать текущее имя хоста воспользуемся командой:
    ```
    hostnamectl
    ```
- Изменим имя хоста с `user-1` на `user-2` с помощью команды:
    ```
    sudo hostnamectl set-hostname user-2
    ```
- Проверим изменения командой:
    ```
    hostname
    ```

    ![](screens/part5.измен_имя_хоста.png)

- Выполним перезагрузку машины командой `reboot` и проверим сохранность изменений:

    ![](screens/part5.last.png)

## Part 6. Установка и настройка службы времени

**== Задание ==**

##### Настроить службу автоматической синхронизации времени.  

- Вывести время, часового пояса, в котором вы сейчас находитесь.
- Вывод следующей команды должен содержать `NTPSynchronized=yes`: \
  `timedatectl show`
- Вставить скрины с корректным временем и выводом команды в отчёт.

**== Решение ==**

- С помощью команды `date` выведем текущее время часового пояса, в котором мы находимся.

- Для вывода настроек часового пояса, используем команду:
    ```
    timedatectl show
    ```

    ![](screens/part6.png)

- >На скриншоте видно, что вывод команды `timedatectl show` содержит `NTPSynchronized=yes`, это соответствует требованию задания. Данная запись свидетельствует о том, что протокол NTP (сетевой протокол времени) активен. NTP - это протокол, отвечающий за синхронизацию времени компьютера со стандартными эталонными часами через интернет с помощью иерархии серверов NTP.

## Part 7. Установка и использование текстовых редакторов 

**== Задание ==**

##### Установить текстовые редакторы **VIM** (+ любые два по желанию **NANO**, **MCEDIT**, **JOE** и т.д.)  
##### Используя каждый из трех выбранных редакторов, создайте файл *test_X.txt*, где X -- название редактора, в котором создан файл. Напишите в нём свой никнейм, закройте файл с сохранением изменений.  
- В отчёт вставьте скриншоты:
  - Из каждого редактора с содержимым файла перед закрытием.
- В отчёте укажите, что сделали для выхода с сохранением изменений.
##### Используя каждый из трех выбранных редакторов, откройте файл на редактирование, отредактируйте файл, заменив никнейм на строку "21 School 21", закройте файл без сохранения изменений.
- В отчёт вставьте скриншоты:
    - Из каждого редактора с содержимым файла после редактирования.
- В отчёте укажите, что сделали для выхода без сохранения изменений.
##### Используя каждый из трех выбранных редакторов, отредактируйте файл ещё раз (по аналогии с предыдущим пунктом), а затем освойте функции поиска по содержимому файла (слово) и замены слова на любое другое.
- В отчёт вставьте скриншоты:
    - Из каждого редактора с результатами поиска слова.
    - Из каждого редактора с командами, введёнными для замены слова на другое.

**== Решение ==**

- Выполним установку текстовых редакторов командами:
    ```
    sudo apt install vim
    ```
    ```
    sudo apt install nano
    ```
    ```
    sudo apt install mcedit
    ```
---
### Запись никнейма в файлы и закрытие с сохранением

- VIM. Запишем никнейм `comedile`:

    ![](screens/part7.vim1.png)

    - Для выхода с сохранением изменений нужно нажать `ESC`, затем написать `:wq`, что означает write and quit.

- NANO. Запишем никнейм `comedile`:

    ![](screens/part7.nano1.png)

    - Для выхода с сохранением изменений нужно нажать `Ctrl+S` и затем `Ctrl+X`.

- MCEDIT. Запишем никнейм `comedile`:

    ![](screens/part7.mcedit1.1.png)

    - Для выхода с сохранением изменений нужно нажать `F10` и выбрать `Yes`

    ![](screens/part7.mcedit1.2.png)

---
### Запись "21 School 21" в файлы с выходом без сохранения

- VIM. Запишем "21 School 21":

    ![](screens/part7.vim2.png)

    - Для выхода без сохранения нужно нажать `ESC`, затем написать `:q!`. Проверим, что изменения не сохранились:

    ![](screens/part7vim.png)

- NANO. Запишем "21 School 21":

    ![](screens/part7.nano2.png)

    - Для выхода без сохранения изменений нужно нажать `Ctrl+X`. Проверим, что изменения не сохранились:

    ![](screens/part7.nano.png)

- MCEDIT. Запишем "21 School 21":

    ![](screens/part7.mcedit2.png)

    - Для выхода без сохранения изменений нужно нажать `F10` и выбрать `No`

    ![](screens/part7.mcedit2.1.png)

    - Проверим, что изменения не сохранились:

    ![](screens/part7.mcedit.png)

---

### Поиск по слову в файлах
- Внесем изменения с предыдущего пункта (запишем в файлы "21 School 21") и сохраним их.

- **VIM**

    - Поиск:
    `ESC + /<слово_для_поиска>`
    
    ![](screens/part7.vim_findword.png)

    - Замена:
    `:s/<заменяемое>/<заменитель>`

    ![](screens/part7.vim_замена_слова.png)

- **NANO**

    - Поиск:
    `Ctrl + W`
    
    ![](screens/part7.nano_поискслова.png)

    - Замена:
    `Ctrl + \`

    ![](screens/part7.nano_замена_слова1.png)

    - Вводим слово для замены:

    ![](screens/part7.nano_замена_слова2.png)

    - Применяем замену:

    ![](screens/part7.nano_замена_слова3.png)

- **MCEDIT**

    - Поиск:
    `F7`
    
    ![](screens/part7.mcedit_поиск_слова1.png)

    - Вводим и подтверждаем слово для поиска:

    ![](screens/part7.mcedit_поиск_слова2.png)

    - Замена:
    `F4`

    ![](screens/part7.mcedit_замена_слова_1.png)

    - Вводим и подтверждаем слово для замены:

    ![](screens/part7.mcedit_замена_слова2.png)

## Part 8. Установка и базовая настройка сервиса **SSHD**

**== Задание ==**

##### Установить службу SSHd.  
##### Добавить автостарт службы при загрузке системы.  
##### Перенастроить службу SSHd на порт 2022.  
##### Используя команду ps, показать наличие процесса sshd. Для этого к команде нужно подобрать ключи.
- В отчёте объяснить значение команды и каждого ключа в ней.
##### Перезагрузить систему.
- В отчёте опишите, что сделали для выполнения всех пяти пунктов (можно как текстом, так и скриншотами).
- Вывод команды netstat -tan должен содержать  \
`tcp 0 0 0.0.0.0:2022 0.0.0.0:* LISTEN`  \
(если команды netstat нет, то ее нужно установить)
- Скрин с выводом команды вставить в отчёт.
- В отчёте объяснить значение ключей -tan, значение каждого столбца вывода, значение 0.0.0.0.

**== Решение ==**

- Установим службу SSHd с помощью команды:
    ```
    sudo apt install openssh-server
    ```

- Узнаем состояние SSHd службы, воспользовавшись командой:
    ```
    sudo systemctl status ssh
    ```

    ![](screens/part8.включение_автозапуск_сервиса.png)

- Как видно на скриншоте, автостарт SSHd службы добавлен автоматически при загрузке. Чтобы включить автостарт можно воспользоваться командой `sudo systemctl enable ssh`, для выключения автостарта команда `sudo systemctl disable ssh`.

- Для перенастройки службы SSHd на порт 2022 откроем файл `sshd_config` с помощью команды:
    ```
    sudo nano /etc/ssh/sshd_config
    ```
- Изменим значение параметра `Port` с 22 на 2022

    ![](screens/part8.изменение_порта_на_2022.png)

- Проверим состояние SSHd службы после изменения порта командой `sudo systemctl status ssh`

    ![](screens/part8.статус_с_измененным_портом.png)

    - На скриншоте видно, что порт изменен.

- Покажем наличие процесса sshd, используя команду:
    ```
    ps aux | grep -i ssh
    ```

    ![](screens/part8.вывод_информации_о_процессах.png)

    - >ps - утилита для просмотра списка процессов в Linux. Параметр `-a` - выбрать все процессы всех пользователей, кроме фоновых. Параметр `-u` обозначает ориентированный на пользователя формат, который предоставляет подробную информацию о процессах. Параметр `-x` указывает `ps` перечислить процессы без управляющего терминала. В основном это процессы, которые запускаются во время загрузки и работают в фоновом режиме.\
    `grep -i ssh` - выводит только те строчки, где есть ssh с игнорированием регистра за счет `-i`.\
    Символ `|` перенаправляет вывод команды `ps aux` на ввод `grep -i ssh`.

- Выполним перезагрузку машины командой `reboot` и выполним команду:
    ```
    netstat -tan
    ```

    ![](screens/part8.вывод_нетстат.png)

- Как видно на скриншоте, вывод команды содержит `tcp 0 0 0.0.0.0:2022 0.0.0.0:* LISTEN`, что соответствует требованию задания.

- >`netstat -tan`\
Команда `netstat` показывает статистику приема и отправки пакетов, а также информацию об ошибках приема и отправки.
`-a` - Вывод всех активных подключений TCP и прослушиваемых компьютером портов TCP и UDP.\
`-n` - Вывод активных подключений TCP с отображением адресов и номеров портов в числовом формате без попыток определения имен.
Тогда, если `netstat -na` - просмотр всех открытых протоколов, то `netstat -tan` - просмотр всех открытых ТСР-протоколов.\
При вызове команды в терминал выводится таблица, столбцы которой имеют следующие значения:\
а) `Proto` - сетевой протокол (tcp, udp);\
б) `Recv-Q` - количество байтов, помещённых в буфер приёма TCP/IP, но не переданных приложению. Если это число высокое, то нужно проверить работоспособность приложения, которое работает с данным портом.\
в) `Send-Q` — количество байтов, помещённых в буфер отправки TCP/IP, но не отправленных, или отправленных, но не подтверждённых. Высокое значение может быть связано с перегрузкой сети сервера.\
г) `Local Address` — локальный адрес сервера. В обычных соединениях, это адрес сервера на который пришло соединение. В прослушиваемых портах (LISTEN) — это диапазон адресов. Так 0.0.0.0:port — значит подключаться можно ко всем адресам сервера, а 192.168.0.35:port — значит подключаться можно только к этому адресу сервера.\
д) `Foreign Address` — адрес второй стороны. В обычных соединениях, это адрес с которого пришло соединение. В прослушиваемых портах (LISTEN) — это диапазон адресов. Так 0.0.0.0:* — значит подключаться можно с любых адресов и с любых портов, а например 192.168.0.50:* — значит подключаться можно только с этого адреса и с любых портов.\
е) `State` — состояние подключения, или прослушивания.

## Part 9. Установка и использование утилит **top**, **htop**

**== Задание ==**

##### Установить и запустить утилиты top и htop.  

- По выводу команды top определить и написать в отчёте:
  - uptime
  - количество авторизованных пользователей
  - общую загрузку системы
  - общее количество процессов
  - загрузку cpu
  - загрузку памяти
  - pid процесса занимающего больше всего памяти
  - pid процесса, занимающего больше всего процессорного времени
- В отчёт вставить скрин с выводом команды htop:
  - отсортированному по PID, PERCENT_CPU, PERCENT_MEM, TIME
  - отфильтрованному для процесса sshd
  - с процессом syslog, найденным, используя поиск 
  - с добавленным выводом hostname, clock и uptime  

**== Решение ==**

- Команда `top` выводит на экран:

    ![](screens/part9.top_вывод.png)

  - uptime - 1 минута;
  - количество авторизованных пользователей - 1;
  - общую загрузку системы - 0.12;
  - общее количество процессов - 126;
  - загрузку cpu - 0.0 %;
  - загрузку памяти - 172.8 из 3187.6;
  - pid процесса занимающего больше всего памяти - 1;
  - pid процесса, занимающего больше всего процессорного времени - 1029.

- htop:
    - Вывод команды без сортировки

    ![](screens/part9.htop_вывод_без_сортировки.png)

    - Для сортировки в `htop` нужно нажать `F6` и выбрать параметр сортировки.
    - `htop` отсортированный по `PID`

    ![](screens/part9.htop_PID_sort.png)

    - `htop` отсортированный по `PERCENT_CPU`

    ![](screens/part9.htop_sort_CPU.png)

    - `htop` отсортированный по `PERCENT_MEM`

    ![](screens/part9.htop_MEM_sort.png)

    - `htop` отсортированный по `TIME`

    ![](screens/part9.htop_TIME_sort.png)

    - Для использования фильтров в `htop` нужно нажать `F4` и выбрать параметр фильтрации.
    - htop, отфильтрованный для процесса SSHd

    ![](screens/part9.htop_filter_sshd.png)

    - Для использования поиска в `htop` нужно нажать `F3` и ввести объект поиска. `htop` с процессом `syslog`, найденным, используя поиск

    ![](screens/part9.htop_syslog_search.png)

    - Для добавления отображения дополнительных параметров в `htop`, необходимо нажать `F2` и добавить требуемые параметры. `htop` с добавленным выводом hostname, clock и uptime

    ![](screens/part9.htop_вывод_времен_и_хоста.png)

## Part 10. Использование утилиты **fdisk**

**== Задание ==**

##### Запустить команду fdisk -l.

- В отчёте написать название жесткого диска, его размер и количество секторов, а также размер swap.

**== Решение ==**

##### Запустить команду fdisk -l.

- Выполним команду:
    ```
    fdisk -l
    ```
    
    ![](screens/image_2023-09-11_10-11-17.png)

    - Название жесткого диска: VBOX HARDDISK (/dev/sda);
    - Размер диска: 15.28 Гигабайт;
    - Количество секторов: 32038112;
    - Размер swap: 0;

## Part 11. Использование утилиты **df** 

**== Задание ==**

##### Запустить команду df.  
- В отчёте написать для корневого раздела (/):
  - размер раздела
  - размер занятого пространства
  - размер свободного пространства
  - процент использования
- Определить и написать в отчёт единицу измерения в выводе.  

##### Запустить команду df -Th.
- В отчёте написать для корневого раздела (/):
    - размер раздела
    - размер занятого пространства
    - размер свободного пространства
    - процент использования
- Определить и написать в отчёт тип файловой системы для раздела.

**== Решение ==**
- Выполним команду:
    ```
    df
    ```

    ![](screens/part11.df_дисковое_пространство_корневого_каталога.png)

    >Для корневого раздела (/):\
        - Размер раздела: 10218772;\
        - Размер занятого пространства: 5772104;\
        - Размер свободного пространства: 3905996;\
        - Процент использования: 60 %;\
        Единицы измерения при выводе: Килобайты.
- Выполним команду:
    ```
    df -Th
    ```

    ![](screens/part11.df_Th.png)

    >Для корневого раздела (/):\
        - Размер раздела: 9.8;\
        - Размер занятого пространства: 5.6;\
        - Размер свободного пространства: 3.8;\
        - Процент использования: 60 %;\
        Единицы измерения при выводе: Гигабайты.\
        Тип файловой системы: Ext4 - журналируемая файловая система, используемая в ОС на ядре Linux. Основана на файловой системе Ext3, но отличается тем, что в ней представлен механизм записи файлов в непрерывные участки блоков (екстенты), уменьшающий фрагментацию и повышающий производительность. В ней есть журналирование, то есть в ней предусмотрена запись некоторых данных, позволяющих восстановить файловую систему при сбоях в работе компьютера.

## Part 12. Использование утилиты **du**

**== Задание ==**

##### Запустить команду du.
##### Вывести размер папок /home, /var, /var/log (в байтах, в человекочитаемом виде)
##### Вывести размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *)

- В отчёт вставить скрины с выводом всех использованных команд.

**== Решение ==**
- Выполним команду:
    ```
    du
    ```

    ![](screens/part12.du_обычный_вызов.png)

- Вывод размера папки /home в байтах и в человекочитаемом виде командами:
    ```
    sudo du -s /home/
    ```
    ```
    sudo du -sh /home/
    ```

    ![](screens/part12.du_home.png)

- Вывод размера папки /var в байтах и в человекочитаемом виде командами:
    ```
    sudo du -s /var/
    ```
    ```
    sudo du -sh /var/
    ```

    ![](screens/part12.du_var.png)

- Вывод размера папки /var/log в байтах и в человекочитаемом виде командами:
    ```
    sudo du -s /var/log/
    ```
    ```
    sudo du -sh /var/log/
    ```

    ![](screens/part12.du_var.log.png)

- Вывод размера всего содержимого папки /var/log в байтах и в человекочитаемом виде командами:
    ```
    sudo du /var/log/
    ```
    ```
    sudo du -h /var/log/
    ```

    ![](screens/part12.du_var.log_full.png)

- Вывод размера всего содержимого папки (каждого вложенного элемента) /var/log с использованием `*` командой:
    ```
    sudo du /var/log/* | less
    ```

    ![](screens/part12.du_star.png)

## Part 13. Установка и использование утилиты **ncdu**

**== Задание ==**

##### Установить утилиту ncdu.
##### Вывести размер папок /home, /var, /var/log.

- Размеры должны примерно совпадать с полученными в [Part 12](#part-12-использование-утилиты-du).

- В отчёт вставить скрины с выводом использованных команд.

**== Решение ==**

- Установим утилиту `ncdu` командой:
    ```
    sudo apt install ncdu
    ```

- Выведем размер папки `/home`:

    ![](screens/part13.ncdu_home.png)

- Выведем размер папки `/var`:

    ![](screens/part13.ncdu_var.png)

- Выведем размер папки `/var/log`:

    ![](screens/part13.ncdu_var.log.png)

- На скриншотах видно, размеры папок примерно совпадают с полученными в `части 12` [Part 12] задания.

## Part 14. Работа с системными журналами

**== Задание ==**

##### Открыть для просмотра:
##### 1. /var/log/dmesg
##### 2. /var/log/syslog
##### 3. /var/log/auth.log  

- Написать в отчёте время последней успешной авторизации, имя пользователя и метод входа в систему.
- Перезапустить службу SSHd.
- Вставить в отчёт скрин с сообщением о рестарте службы (искать в логах).

**== Решение ==**

- `/var/log/dmesg` — драйвера устройств. Содержит сообщения, полученные от ядра. Регистрирует много сообщений еще на этапе загрузки, в них отображается информация об аппаратных устройствах, которые инициализируются в процессе загрузки. Одноименной командой можно просмотреть вывод содержимого файла. Размер журнала ограничен, когда файл достигнет своего предела, старые сообщения будут перезаписаны более новыми. Откроем для просмотра файл `/var/log/dmesg` с помощью команды:
    ```
    less /var/log/dmesg
    ```

    ![](screens/part14.logs_dmesg.png)

- `/var/log/syslog` — содержит глобальный системный журнал, в котором пишутся сообщения с момента запуска системы, от ядра Linux, различных служб, обнаруженных устройствах, сетевых интерфейсов и много другого. Откроем для просмотра файл `/var/log/syslog` с помощью команды:
    ```
    less /var/log/syslog
    ```

    ![](screens/part14.logs_syslog.png)

- `/var/log/auth.log` — информация об авторизации пользователей, включая удачные и неудачные попытки входа в систему, а также задействованные механизмы аутентификации. Откроем для просмотра файл `/var/log/auth.log` с помощью команды:
    ```
    less /var/log/auth.log
    ```

    ![](screens/part14.png)

- Время последней успешной авторизации: sep 7, 15:52:52
- Имя пользователя: user1
- Метод входа в систему: by uid = 0 (User Identifier). Суперпользователь всегда должен иметь UID, равный нулю (0).

- Перезапустим службу SSHd с помощью команды:
    ```
    sudo systemctl restart ssh
    ```
- В журнале найдем сообщение о перезапуске службы:

    ![](screens/part14.logs_sshd_restart.png)

## Part 15. Использование планировщика заданий **CRON**

**== Задание ==**

##### Используя планировщик заданий, запустите команду uptime через каждые 2 минуты.
- Найти в системных журналах строчки (минимум две в заданном временном диапазоне) о выполнении.
- Вывести на экран список текущих заданий для CRON.
- Вставить в отчёт скрины со строчками о выполнении и списком текущих задач.

##### Удалите все задания из планировщика заданий.
- В отчёт вставьте скрин со списком текущих заданий для CRON.

**== Решение ==**

- Запустим команду `uptime` через каждые 2 минуты. Для этого откроем планировщик заданий `CRON` в текстовом редакторе `nano` с помощью команды:
```
crontab -e
```
- Добавим строчку `*/2 * * * * uptime`

    ![](screens/part15.cron_каждые_2_минуты.png)

- После чего сохраним и закроем файл.
- Найдем в системных журналах строчки о выполнении `uptime`. Для этого воспользуемся командой:
    ```
    less /var/log/syslog | grep CRON
    ```

    ![](screens/part15.cron_uptime_check.png)

- Выведем на экран список текущих заданий для `CRON` с помощью команды:
    ```
    crontab -l
    ```

    ![](screens/part15.cron_-l.png)

- Удалим все задания из планировщика заданий `CRON` с помощью команды:
    ```
    crontab -r
    ```
- Проверим список текщих задач после удаления командой `crontab -l`:

    ![](screens/part15.last.png)
